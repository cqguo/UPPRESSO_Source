\section{Conclusion}
\label{sec:conclusion}
In this paper, we propose UPPRESSO, an untraceable and unlinkable privacy-preserving single sign-on system,
 to protect a user's login activities at different RPs against both the curious IdP and collusive RPs.
To the best of our knowledge,
 UPPRESSO is the first practical approach
    that defends against both the privacy threats of IdP-based login tracing and RP-based identity linkage.
To achieve these goals, we convert the identity dilemma in privacy-preserving SSO services into an identity-transformation challenge
 and design three functions satisfying the requirements,
 where $\mathcal{F}_{PID_{RP}}$ protects the RP's identity from the curious IdP,
 $\mathcal{F}_{PID_{U}}$ prevents collusive RPs from linking a user based on his identities at these RPs,
 and $\mathcal{F}_{Acct}$ allows the RP to derive an identical account for a user in his multiple login instances.
The three functions can be integrated with existing SSO protocols,
    such as OIDC,
    to enhance the protections of user privacy,
    while without breaking any security guarantees of  SSO systems.
The experimental evaluation of the UPPRESSO prototype demonstrates
 that it provides efficient SSO services, where a login instance takes only 310 ms on average.
